{"ast":null,"code":"import React,{useState,useEffect}from'react';import{BrowserRouter as Router,Routes,Route,Navigate}from'react-router-dom';import axios from'axios';// Components\nimport Landing from'./pages/Landing';import Login from'./pages/Login';import Register from'./pages/Register';import Dashboard from'./pages/Dashboard';import ReportIncident from'./pages/ReportIncident';import MyReports from'./pages/MyReports';import Admin from'./pages/Admin';// Set axios base URL from environment variables\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";axios.defaults.baseURL=process.env.REACT_APP_API_URL||'http://localhost:5000/api';// ✅ allow cross-origin cookies and authentication headers\naxios.defaults.withCredentials=true;function App(){const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{// Debug: Check environment variables\nconsole.log('API URL:',process.env.REACT_APP_API_URL);console.log('NODE_ENV:',process.env.NODE_ENV);const token=localStorage.getItem('token');if(token){axios.defaults.headers.common['Authorization']=\"Bearer \".concat(token);fetchUser();}else{setLoading(false);}},[]);const fetchUser=async()=>{try{const res=await axios.get('/auth/me');setUser(res.data.user);}catch(error){console.error('Error fetching user:',error);localStorage.removeItem('token');delete axios.defaults.headers.common['Authorization'];}setLoading(false);};const login=(token,userData)=>{localStorage.setItem('token',token);axios.defaults.headers.common['Authorization']=\"Bearer \".concat(token);setUser(userData);};const logout=()=>{localStorage.removeItem('token');delete axios.defaults.headers.common['Authorization'];setUser(null);};if(loading){return/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',height:'100vh',fontSize:'1.2rem'},children:\"Loading...\"});}return/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Landing,{})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:!user?/*#__PURE__*/_jsx(Login,{onLogin:login}):user.role==='counselor'?/*#__PURE__*/_jsx(Navigate,{to:\"/admin\"}):/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\"})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:!user?/*#__PURE__*/_jsx(Register,{onRegister:login}):user.role==='counselor'?/*#__PURE__*/_jsx(Navigate,{to:\"/admin\"}):/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\"})}),/*#__PURE__*/_jsx(Route,{path:\"/dashboard\",element:user?user.role==='counselor'?/*#__PURE__*/_jsx(Navigate,{to:\"/admin\"}):/*#__PURE__*/_jsx(Dashboard,{user:user,onLogout:logout}):/*#__PURE__*/_jsx(Navigate,{to:\"/login\"})}),/*#__PURE__*/_jsx(Route,{path:\"/report\",element:user?user.role==='counselor'?/*#__PURE__*/_jsx(Navigate,{to:\"/admin\"}):/*#__PURE__*/_jsx(ReportIncident,{user:user}):/*#__PURE__*/_jsx(Navigate,{to:\"/login\"})}),/*#__PURE__*/_jsx(Route,{path:\"/my-reports\",element:user?user.role==='counselor'?/*#__PURE__*/_jsx(Navigate,{to:\"/admin\"}):/*#__PURE__*/_jsx(MyReports,{user:user}):/*#__PURE__*/_jsx(Navigate,{to:\"/login\"})}),/*#__PURE__*/_jsx(Route,{path:\"/admin\",element:user&&user.role==='counselor'?/*#__PURE__*/_jsx(Admin,{user:user,onLogout:logout}):/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\"})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/\"})})]})})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","BrowserRouter","Router","Routes","Route","Navigate","axios","Landing","Login","Register","Dashboard","ReportIncident","MyReports","Admin","jsx","_jsx","jsxs","_jsxs","defaults","baseURL","process","env","REACT_APP_API_URL","withCredentials","App","user","setUser","loading","setLoading","console","log","NODE_ENV","token","localStorage","getItem","headers","common","concat","fetchUser","res","get","data","error","removeItem","login","userData","setItem","logout","style","display","justifyContent","alignItems","height","fontSize","children","className","path","element","onLogin","role","to","onRegister","onLogout"],"sources":["/home/wande/Desktop/Irene MERN Stack/mern-final-project-irenenderitu/client/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';\nimport axios from 'axios';\n\n// Components\nimport Landing from './pages/Landing';\nimport Login from './pages/Login';\nimport Register from './pages/Register';\nimport Dashboard from './pages/Dashboard';\nimport ReportIncident from './pages/ReportIncident';\nimport MyReports from './pages/MyReports';\nimport Admin from './pages/Admin';\n\n// Set axios base URL from environment variables\naxios.defaults.baseURL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\n\n// ✅ allow cross-origin cookies and authentication headers\naxios.defaults.withCredentials = true;\n\nfunction App() {\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    // Debug: Check environment variables\n    console.log('API URL:', process.env.REACT_APP_API_URL);\n    console.log('NODE_ENV:', process.env.NODE_ENV);\n    \n    const token = localStorage.getItem('token');\n    if (token) {\n      axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      fetchUser();\n    } else {\n      setLoading(false);\n    }\n  }, []);\n\n  const fetchUser = async () => {\n    try {\n      const res = await axios.get('/auth/me');\n      setUser(res.data.user);\n    } catch (error) {\n      console.error('Error fetching user:', error);\n      localStorage.removeItem('token');\n      delete axios.defaults.headers.common['Authorization'];\n    }\n    setLoading(false);\n  };\n\n  const login = (token, userData) => {\n    localStorage.setItem('token', token);\n    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n    setUser(userData);\n  };\n\n  const logout = () => {\n    localStorage.removeItem('token');\n    delete axios.defaults.headers.common['Authorization'];\n    setUser(null);\n  };\n\n  if (loading) {\n    return (\n      <div style={{ \n        display: 'flex', \n        justifyContent: 'center', \n        alignItems: 'center', \n        height: '100vh',\n        fontSize: '1.2rem'\n      }}>\n        Loading...\n      </div>\n    );\n  }\n\n  return (\n    <Router>\n      <div className=\"App\">\n        <Routes>\n          {/* Public routes */}\n          <Route path=\"/\" element={<Landing />} />\n          <Route \n            path=\"/login\" \n            element={\n              !user \n                ? <Login onLogin={login} /> \n                : user.role === 'counselor' \n                  ? <Navigate to=\"/admin\" /> \n                  : <Navigate to=\"/dashboard\" />\n            } \n          />\n          <Route \n            path=\"/register\" \n            element={\n              !user \n                ? <Register onRegister={login} /> \n                : user.role === 'counselor' \n                  ? <Navigate to=\"/admin\" /> \n                  : <Navigate to=\"/dashboard\" />\n            } \n          />\n          \n          {/* Protected routes */}\n          <Route \n            path=\"/dashboard\" \n            element={\n              user \n                ? user.role === 'counselor' \n                  ? <Navigate to=\"/admin\" /> \n                  : <Dashboard user={user} onLogout={logout} /> \n                : <Navigate to=\"/login\" />\n            } \n          />\n          <Route \n            path=\"/report\" \n            element={\n              user \n                ? user.role === 'counselor' \n                  ? <Navigate to=\"/admin\" /> \n                  : <ReportIncident user={user} /> \n                : <Navigate to=\"/login\" />\n            } \n          />\n          <Route \n            path=\"/my-reports\" \n            element={\n              user \n                ? user.role === 'counselor' \n                  ? <Navigate to=\"/admin\" /> \n                  : <MyReports user={user} /> \n                : <Navigate to=\"/login\" />\n            } \n          />\n          <Route \n            path=\"/admin\" \n            element={\n              user && user.role === 'counselor' \n                ? <Admin user={user} onLogout={logout} /> \n                : <Navigate to=\"/dashboard\" />\n            } \n          />\n          \n          {/* Catch all route */}\n          <Route path=\"*\" element={<Navigate to=\"/\" />} />\n        </Routes>\n      </div>\n    </Router>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}